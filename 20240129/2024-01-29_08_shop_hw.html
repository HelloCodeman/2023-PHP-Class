<!DOCTYPE html>
<html lang="en">

<head>
  <title>泰山雜貨店</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- bs.css -->
  <link href="./js/bs.css" rel="stylesheet">
  <!-- font-awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
  <!-- google-font -->
  <link href="https://fonts.googleapis.com/css2?family=Acme&display=swap" rel="stylesheet">
  <style>
    /* *,
    *:after,
    *:before {
      box-sizing: border-box;
    } */

    body {
      height: 100vh;
      font-weight: 140;
      font-family: 'Acme', sans-serif;
      background-color: #eee;
      -ms-overflow-style: none;
    }

    .openingCover {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      background-color: #222222;
      position: fixed;
      left: 0;
      top: 0;
      z-index: 100;
      width: 100%;
      height: 100%;
    }

    .welcome {
      font-size: 80px;
      color: #dabea7;
      margin-bottom: 10px;
      font-family: 'Acme', sans-serif;
    }

    .loadingBar {
      position: relative;
      margin-top: 20px;
      width: 100vw;
      height: 1px;
      border-radius: 5px;
      background-color: rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .loadingValue {
      position: absolute;
      background-color: #dbc5a4;
      width: 0;
      height: 3px;
    }

    /* width */
    ::-webkit-scrollbar {
      width: 10px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
      box-shadow: inset 0 0 5px grey;
      border-radius: 10px;
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
      background: #979b9a;
      border-radius: 10px;
    }

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
      background: #6cacd6;
    }

    ::-webkit-scrollbar {
      display: none;
    }

    /* Generated by Animista */
    .welcome {
      -webkit-animation: welcome 1.5s cubic-bezier(0.445, 0.050, 0.550, 0.950) 0.2s both;
      animation: welcome 1.5s cubic-bezier(0.445, 0.050, 0.550, 0.950) 0.2s both;
    }

    @-webkit-keyframes welcome {
      0% {
        letter-spacing: -0.5em;
        opacity: 0;
      }

      40% {
        opacity: 0.6;
      }

      100% {
        opacity: 1;
      }
    }

    @keyframes welcome {
      0% {
        letter-spacing: -0.5em;
        opacity: 0;
      }

      40% {
        opacity: 0.6;
      }

      100% {
        opacity: 1;
      }
    }

    h1 {
      text-align: center;
    }

    .jello-horizontal:hover {
      -webkit-animation: jello-horizontal 0.5s linear both;
      animation: jello-horizontal 0.5s linear both;
    }

    @-webkit-keyframes jello-horizontal {
      0% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
      }

      30% {
        -webkit-transform: scale3d(1.25, 0.75, 1);
        transform: scale3d(1.25, 0.75, 1);
      }

      40% {
        -webkit-transform: scale3d(0.75, 1.25, 1);
        transform: scale3d(0.75, 1.25, 1);
      }

      50% {
        -webkit-transform: scale3d(1.15, 0.85, 1);
        transform: scale3d(1.15, 0.85, 1);
      }

      65% {
        -webkit-transform: scale3d(0.95, 1.05, 1);
        transform: scale3d(0.95, 1.05, 1);
      }

      75% {
        -webkit-transform: scale3d(1.05, 0.95, 1);
        transform: scale3d(1.05, 0.95, 1);
      }

      100% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
      }
    }

    @keyframes jello-horizontal {
      0% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
      }

      30% {
        -webkit-transform: scale3d(1.25, 0.75, 1);
        transform: scale3d(1.25, 0.75, 1);
      }

      40% {
        -webkit-transform: scale3d(0.75, 1.25, 1);
        transform: scale3d(0.75, 1.25, 1);
      }

      50% {
        -webkit-transform: scale3d(1.15, 0.85, 1);
        transform: scale3d(1.15, 0.85, 1);
      }

      65% {
        -webkit-transform: scale3d(0.95, 1.05, 1);
        transform: scale3d(0.95, 1.05, 1);
      }

      75% {
        -webkit-transform: scale3d(1.05, 0.95, 1);
        transform: scale3d(1.05, 0.95, 1);
      }

      100% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
      }
    }

    .jello-vertical:hover {
      -webkit-animation: jello-vertical 0.5s both;
      animation: jello-vertical 0.5s both;
    }

    @-webkit-keyframes jello-vertical {
      0% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
      }

      30% {
        -webkit-transform: scale3d(0.75, 1.25, 1);
        transform: scale3d(0.75, 1.25, 1);
      }

      40% {
        -webkit-transform: scale3d(1.25, 0.75, 1);
        transform: scale3d(1.25, 0.75, 1);
      }

      50% {
        -webkit-transform: scale3d(0.85, 1.15, 1);
        transform: scale3d(0.85, 1.15, 1);
      }

      65% {
        -webkit-transform: scale3d(1.05, 0.95, 1);
        transform: scale3d(1.05, 0.95, 1);
      }

      75% {
        -webkit-transform: scale3d(0.95, 1.05, 1);
        transform: scale3d(0.95, 1.05, 1);
      }

      100% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
      }
    }

    @keyframes jello-vertical {
      0% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
      }

      30% {
        -webkit-transform: scale3d(0.75, 1.25, 1);
        transform: scale3d(0.75, 1.25, 1);
      }

      40% {
        -webkit-transform: scale3d(1.25, 0.75, 1);
        transform: scale3d(1.25, 0.75, 1);
      }

      50% {
        -webkit-transform: scale3d(0.85, 1.15, 1);
        transform: scale3d(0.85, 1.15, 1);
      }

      65% {
        -webkit-transform: scale3d(1.05, 0.95, 1);
        transform: scale3d(1.05, 0.95, 1);
      }

      75% {
        -webkit-transform: scale3d(0.95, 1.05, 1);
        transform: scale3d(0.95, 1.05, 1);
      }

      100% {
        -webkit-transform: scale3d(1, 1, 1);
        transform: scale3d(1, 1, 1);
      }
    }

    .tracking-in-contract-bck-bottom {
      -webkit-animation: tracking-in-contract-bck-bottom 2s cubic-bezier(0.215, 0.610, 0.355, 1.000) 10s 3 both;
      animation: tracking-in-contract-bck-bottom 2s cubic-bezier(0.215, 0.610, 0.355, 1.000) 10s 3 both;
      font-size: 20px;
      letter-spacing: 15px;
    }

    @-webkit-keyframes tracking-in-contract-bck-bottom {
      0% {
        letter-spacing: 1em;
        -webkit-transform: translateZ(400px) translateY(300px);
        transform: translateZ(400px) translateY(300px);
        opacity: 0;
      }

      40% {
        opacity: 0.6;
      }

      100% {
        -webkit-transform: translateZ(0) translateY(0);
        transform: translateZ(0) translateY(0);
        opacity: 1;
      }
    }

    @keyframes tracking-in-contract-bck-bottom {
      0% {
        letter-spacing: 1em;
        -webkit-transform: translateZ(400px) translateY(300px);
        transform: translateZ(400px) translateY(300px);
        opacity: 0;
      }

      40% {
        opacity: 0.6;
      }

      100% {
        -webkit-transform: translateZ(0) translateY(0);
        transform: translateZ(0) translateY(0);
        opacity: 1;
      }
    }

    .table {
      background-color: none;
    }
  </style>
</head>

<body>
  <!-- opening animation start-->
  <!-- <section class="openingCover">
    <section class="welcome">Welcome</section>
    <section class="loadingBar">
      <section class="loadingValue"></section>
    </section>
  </section> -->
  <!-- opening animation end -->

  <div class="container-fluid">
    <div class="container-fluid">
      <h1><img src="./img/resturant.png" style="width: 110px;height: 100px;"><img src="./img/Vanilla-1s-220px.gif"
          style="width: 200px;height: 80px;" class="mt-2"></h1>
      <div class="row mt-3 text-center">
        <div class="col-5"></div>
        <div class="col text-start">
          <img src="./img/Vanilla-1s-75px-Drink.gif">
          <button type="button" class="myBtn btn btn-primary jello-horizontal" data-name="咖啡" data-price="100"
            data-img="coffee">
            <!-- <img src="./coffee-1.1s-120px.png" alt=""> -->
            咖啡
          </button>
          <button type="button" class="myBtn btn btn-primary jello-horizontal" data-name="花茶" data-price="200"
            data-img="tea">
            花茶
          </button>
          <button type="button" class="myBtn btn btn-primary jello-horizontal" data-name="礦泉水" data-price="50"
            data-img="water">
            礦泉水
          </button>
        </div>
        <div class="col"></div>
      </div>
      <div class="row mt-3 text-center">
        <div class="col-5"></div>
        <div class="col text-start">
          <img src="./img/Vanilla-1s-75px-Food.gif" style="scale: 1.1;">
          <button type="button" class="myBtn btn btn-success jello-vertical" data-name="手工餅乾" data-price="120"
            data-img="cookies" data-id="1">
            手工餅乾
          </button>
          <button type="button" class="myBtn btn btn-success jello-vertical" data-name="吐司" data-price="65"
            data-img="toast">
            吐司
          </button>
          <button type="button" class="myBtn btn btn-success jello-vertical" data-name="馬卡龍" data-price="50"
            data-img="macaron">
            馬卡龍
          </button>
        </div>
        <div class="col"></div>
      </div>
    </div>
    <br>
    <div class="container-fluid">
      <table class="table table-hover align-middle text-center">
        <thead>
          <tr>
            <th width="15%">品項</th>
            <th width="30%">描述</th>
            <th width="20%" class="text-start">操作</th>
          </tr>
        </thead>
        <tbody>
          <!-- <tr>
        <td>
          <img class="rounded-circle" src="./coffee-1.1s-120px.png" alt="">
        </td>
        <td class="text-start">
          咖啡
          <br>
          單價 <span>100</span>元
          <div class="mb-3">
            <label for="" class="form-label">數量</label>
            <input type="number" class="form-control" id="" max="20" min="1" value="1">
          </div>
          <hr>
          小計 : <span>100</span>
        </td>
        <td class="text-start">
          <button type="button" class="cloneBtn btn btn-warning">Clone</button>
          <button type="button" class="delBtn btn btn-danger">Del</button>
        </td>
      </tr> -->
        </tbody>
      </table>
    </div>

    <div class="container-fluid mt-3">
      <div class="row">
        <div class="col">
          <div class="text-center">
            <img src="./img/Vanilla-2s-120px.gif" class="mb-4"><span id="mySum" class="display-4">0</span> 元
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- <section class="tracking-in-contract-bck-bottom text-center">祝您用餐愉快<br>歡迎再次光臨</section> -->

  <!-- bootstrap.js -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.js'></script>
  <!-- swiper.js -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.js'></script>
  <!-- jQuery -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.js'></script>
  <!-- gsap.js -->
  <script src="../20240118/gsap/gsap.js"></script>
  <script src="../20240118/gsap/ScrollTrigger.js"></script>
  <script src="../20240118/gsap/TextPlugin.js"></script>
  <!-- vanta.js -->
  <script src="./js/three.r134.min.js"></script>
  <script src="./js/vanta.fog.min.js"></script>
  <script>


    // header cover: website opening animation
    const loadingtl = gsap.timeline();

    loadingtl
      .to(".loadingValue", 2, { width: "100%" })
      .to(".loadingBar", 0, { display: 'none' })
      .to(".welcome", 0, { display: 'none' })
      .to(".openingCover", 0.5, { height: 0 })


    $(document).ready(function () {
      function sumFun() {
        console.log('sumBtn ok');
        let myTotal = $('.myTotal');
        let getMyTotalCount = myTotal.length;
        console.log('myTotal', myTotal);
        let sum = 0;
        myTotal.each(function (index, value) {
          console.log('index', index);
          console.log('value', value);
          sum = sum + Number($(value).text());
        });
        console.log('final sum', sum);
        mySum.text(sum);
      }


      function delFun(nowThis) {
        console.log('del ok');
        let nowTr = $(nowThis).parent().parent();
        nowTr.remove();
        sumFun();


        // 抓tr數量
        // 如果tr <=2 不能刪除

        // 抓tr數量
        // let getTrCount = $('tr').length;
        // console.log('getTrCount', getTrCount);
        // 如果tr <= 2 不能刪除
        // if (getTrCount > 2) {
        //   let nowTr = $(nowThis).parent().parent();
        //   nowTr.remove();
        // }
      }

      function cloneFun(nowThis) {
        console.log('clone ok');
        let nowTr = $(nowThis).parent().parent();
        // nowTr.clone(true).appendTo("tbody");
        nowTr.clone(true).insertAfter(nowTr);
        sumFun();
      }

      const myBtn = $('.myBtn');
      const mySum = $('#mySum');
      const sumBtn = $('#sumBtn');
      let delBtn = $('.delBtn');
      let cloneBtn = $('.cloneBtn');


      //sumBtn click
      sumBtn.click(function (e) {
        sumFun();
      });

      // init cloneBtn
      cloneBtn.click(function (e) {
        cloneFun(this);
      });

      // init delBtn
      delBtn.click(function (e) {
        delFun(this);
      });

      myBtn.click(function (e) {
        let name = $(this).attr('data-name');
        let price = $(this).attr('data-price');
        let imgUrl = $(this).attr('data-img');


        let content = `
        <tr>
          <td>
            <img class="rounded-circle" src="./img/${imgUrl}-1.1s-120px.png" alt="">
            </td>
            <td class="text-start">
              <b>${name}</b>
              <br>
              單價 <span>${price}</span>元
              <div class="mb-3">
                <label for="" class="form-label">數量</label>
                <input type="number" class="quantity form-control" id="" max="20" min="1" value="1">
                </div>
                小計 : <span class="myTotal">${price}</span>
                </td>
                <td class="text-start">
                  <button type="button" class="cloneBtn btn btn-warning">增加</button>
                  <button type="button" class="delBtn btn btn-danger">刪除</button>
                  </td>
                  </tr>
                  `;

        $('tbody').append(content);

        addDelBtn = $('.delBtn').last();
        addCloneBtn = $('.cloneBtn').last();
        addQuantity = $('.quantity').last();

        sumFun();

        // addDelBtn
        addDelBtn.click(function (e) {
          delFun(this);
        });

        // addCloneBtn
        addCloneBtn.click(function (e) {
          cloneFun(this);
        });

        // addQuantity
        addQuantity.change(function (e) {
          let getQuantity = Number($(this).val());
          let closestQuantityTr = $(this).parent().parent().parent();
          let findTotal = closestQuantityTr.find('.myTotal');
          console.log('closestQuantityTr', closestQuantityTr);
          console.log('getQuantity', getQuantity);
          let total = getQuantity * price;
          console.log('total', total);
          findTotal.text(total);

          sumFun();
        });

      });
    });

    VANTA.FOG({
      el: "html",
      mouseControls: true,
      touchControls: true,
      gyroControls: false,
      minHeight: 200.00,
      minWidth: 200.00,
      highlightColor: 0xebdeb4,
      midtoneColor: 0xf2f2f2,
      lowlightColor: 0xd0c9e3,
      blurFactor: 0.57,
      speed: 4.10,
      zoom: 2.50
    })
  </script>
</body>

</html>